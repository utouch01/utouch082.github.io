/*!
jquery.roamiGmap.min.js 2017-08-20
version: 1.0.0 */
(function(o){o.fn.roamiGmap=function(e){if(this.length===0){return this}var n=o.extend({},o.fn.roamiGmap.defaults,e);if(!o.fn.roamiGmap.APILoaded&&""!==n.key){var i=document.createElement("script"),a=document.getElementsByTagName("script")[0];i.src="https://maps.googleapis.com/maps/api/js?key=";i.src+=n.key;i.src+="&libraries=places&callback=jQuery.fn.roamiGmap.gmapsAPILoaded";a.parentNode.insertBefore(i,a);o.fn.roamiGmap.APILoaded=true}var r=this,t,s,f,c=[];var l=function(){if(!n.key.length){console.error("roamiGmap(): Please provide a Google Maps API Key.");return false}else{o(document).on("apiHasLoaded",p);r.css("min-height",n.minHeight)}},p=function(){if(!s){s=new google.maps.Geocoder;if(!s){console.error("roamiGmap() - could not build the Geocoder object.");return false}}if(!n.center||""===n.center){console.error("roamiGmap() - @param center is required.");return false}s.geocode({address:n.center},function(e,i){if(i!=="OK"){console.error("roamiGmap() - Geocode was not successful for the following reason: "+i);return false}else{r.location=e[0].geometry.location;var a=o.extend({},{center:r.location,zoom:n.zoom},n.mapOptions);t=new google.maps.Map(r[0],a);r.gmap=t;r.marker=n.marker?m(n.marker):n.marker;r.infowindow=d(n.infowindow,r.marker);if("function"===typeof n.onMapLoad){n.onMapLoad.call(r)}}})},m=function(o,e){o="object"===typeof o?o:u();if(!o.map)o["map"]=t;if(!o.position)o["position"]=r.location;if(o.animation&&""!==o.animation)o.animation=google.maps.Animation[g(o.animation)];var n=new google.maps.Marker(o),i;c.push(n);if(e){i=d(e,n);return{marker:n,infowindow:i}}else{return n}},d=function(e,i){e=e||{};i=i||false;if(i&&e&&!o.isEmptyObject(e)){var a=new google.maps.InfoWindow(e);if(n.bindInfowindow){google.maps.event.addListener(i,"click",function(){if(n.autoCloseInfowindow){if(r.infowindows.length){for(var o=r.infowindows.length-1;o>=0;o--){if(r.infowindows[o].map){r.infowindows[o].close()}}}}a.open(t,i)})}if(!r.infowindows||!r.infowindows.length){r.infowindows=[a]}else{r.infowindows.push(a)}return a}return false},u=function(){return{map:t,position:r.location,title:r.center}},g=function(o){return"drop"==o.toLowerCase()||"bounce"==o.toLowerCase()?o.toUpperCase():""};r.addMarker=function(o,e){o=o||{};var n={};if("object"!==typeof o.position){s.geocode({address:o.position},function(i,a){if(a==="OK"){o.position=i[0].geometry.location;n=m(o,e)}else{console.error("roamiGmap() - Geocode was not successful for the following reason: "+a);return false}})}else{n=m(o,e)}return n};r.getMarkers=function(){return c};r.searchPlaces=function(o,e){o=o||{};if("function"!==typeof e){e=function(o,e){if(e===google.maps.places.PlacesServiceStatus.OK){for(var n=0;n<o.length;n++){var i="<h4>"+o[n].name+"</h4>";i+=o[n].opening_hours&&o[n].opening_hours.open_now?"<p>Opened.</p>":"<p>Closed.</p>";r.addMarker({position:o[n].geometry.location},{content:i})}}}}o.location=o.location||this.location;o.radius=o.radius||500;o.type=o.type||[];if(!f){f=new google.maps.places.PlacesService(r.gmap);if(!f){console.error("roamiGmap() - could not build the Places object.");return false}}f.nearbySearch(o,e)};o.fn.roamiGmap.gmapsAPILoaded=function(){o(document).trigger("apiHasLoaded");console.log("Google API Has Loaded.")};if(1<this.length){o(this).each(function(){o(this).roamiGmap(e)})}l();return this};o.fn.roamiGmap.APILoaded=false;o.fn.roamiGmap.defaults={center:"",marker:true,infowindow:{},autoCloseInfowindow:true,infowindows:false,key:"",zoom:15,minHeight:300,bindInfowindow:true,mapOptions:{},onMapLoad:function(){return true}}})(jQuery);